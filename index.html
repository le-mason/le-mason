<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conjug8 ¬∑ d√©fi verbes</title>
    <!-- Google Font & clean base -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(145deg, #f0f3f7 0%, #dee5ed 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .app-container {
            max-width: 1000px;
            width: 100%;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            border-radius: 48px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            padding: 36px;
            border: 1px solid rgba(255,255,255,0.7);
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        h1 {
            font-weight: 700;
            font-size: 1.9rem;
            color: #1e3b4c;
            letter-spacing: -0.02em;
        }

        .badge {
            background: #2f5a70;
            color: white;
            padding: 8px 20px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }

        /* sentence card */
        .sentence-card {
            background: white;
            border-radius: 32px;
            padding: 36px 32px;
            margin-bottom: 28px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.02);
            border: 1px solid #edf2f9;
        }

        .english-sentence {
            font-size: 1.6rem;
            font-weight: 600;
            color: #1e3f52;
            margin-bottom: 24px;
            border-bottom: 2px solid #e2eaf0;
            padding-bottom: 18px;
            line-height: 1.3;
        }

        .french-building {
            font-size: 2.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            color: #0f2e3f;
        }

        .blank {
            display: inline-block;
            min-width: 180px;
            background: #f4f9ff;
            border-radius: 20px;
            padding: 8px 24px;
            border: 3px dashed #6f8fa2;
            color: #1e3b4a;
            font-weight: 700;
            text-align: center;
            transition: all 0.1s;
            font-size: 1.9rem;
        }

        .blank.filled {
            background: #e1eff9;
            border: 3px solid #26648b;
            border-style: solid;
            color: #0a4b6e;
        }

        .rest-phrase {
            background: #eef3f8;
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 1.7rem;
            font-weight: 500;
            color: #2a556b;
        }

        /* action row */
        .action-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 28px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .feedback {
            background: #fef9e7;
            border-radius: 60px;
            padding: 14px 26px;
            border-left: 8px solid #ffae42;
            color: #4a3b1a;
            font-weight: 500;
            font-size: 1.05rem;
            flex: 1;
        }

        .btn-group {
            display: flex;
            gap: 14px;
        }

        .btn {
            border: none;
            background: white;
            padding: 14px 28px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: 0.12s;
            border: 2px solid #cbd5e1;
            color: #1e3a4e;
            box-shadow: 0 3px 0 #b0bec5;
        }

        .btn:hover {
            background: #f8fcff;
            border-color: #7e9eb5;
            transform: translateY(-2px);
            box-shadow: 0 5px 0 #9aa9b5;
        }

        .btn-primary {
            background: #1d4e67;
            border-color: #1d4e67;
            color: white;
            box-shadow: 0 3px 0 #0d3140;
        }
        .btn-primary:hover {
            background: #256c8a;
            border-color: #1d5a73;
            color: white;
        }

        /* verb grid ‚Äî clean, no colors, no labels */
        .toolbox-label {
            font-size: 0.95rem;
            font-weight: 700;
            color: #4c5c6b;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 18px;
        }

        .verb-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .verb-btn {
            border: none;
            padding: 16px 28px;
            border-radius: 60px;
            font-size: 1.4rem;
            font-weight: 600;
            background: white;
            box-shadow: 0 5px 0 #bac8d3, 0 10px 20px rgba(0,0,0,0.05);
            transition: all 0.06s linear;
            cursor: pointer;
            border: 2px solid white;
            color: #1e2e3f;
            min-width: 110px;
            background: #fafdff;
            border: 2px solid #e2edf2;
        }

        .verb-btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #9aa9b5, 0 10px 20px rgba(0,0,0,0.05);
        }

        .verb-btn.disabled,
        .verb-btn[disabled] {
            opacity: 0.4;
            transform: translateY(4px);
            box-shadow: 0 2px 0 #bac8d3;
            pointer-events: none;
        }

        .footer-note {
            margin-top: 30px;
            color: #5a6e7c;
            font-size: 0.85rem;
            text-align: center;
            border-top: 1px solid #d0dce5;
            padding-top: 22px;
        }
    </style>
</head>
<body>
<div class="app-container">
    <div class="app-header">
        <h1>‚ö° Conjug8 ¬∑ choisis la forme</h1>
        <span class="badge">verbes ¬∑ mix quotidien</span>
    </div>

    <!-- ======= SENTENCE ZONE ======= -->
    <div class="sentence-card">
        <div class="english-sentence" id="englishSentence">I must go to the store.</div>
        <div class="french-building">
            <span id="subjectPart">Je</span>
            <span id="blankSpace" class="blank">______</span>
            <span id="restOfSentence" class="rest-phrase">aller au magasin.</span>
        </div>

        <!-- feedback + next & reset (no extra "nouvelle phrase" text) -->
        <div class="action-row">
            <div class="feedback" id="feedbackMessage">üëâ Trouve la bonne conjugaison.</div>
            <div class="btn-group">
                <button id="resetBtn" class="btn">‚Üª R√©initialiser</button>
                <button id="nextBtn" class="btn btn-primary">‚è© Suivant</button>
            </div>
        </div>
    </div>

    <!-- ======= VERB BUTTONS ‚Äì NO SUBJECT, NO COLOR ======= -->
    <div class="toolbox-label">üõ†Ô∏è appuie sur le verbe correct</div>
    <div id="verbContainer" class="verb-grid">
        <!-- injected: includes multiple conjugated forms of the same verb for challenge -->
    </div>

    <div class="footer-note">
        üî§ Attention : plusieurs formes du m√™me verbe sont pr√©sentes. Choisis celle qui correspond au sujet.
    </div>
</div>

<script>
    // ---------- LARGE BANK OF EVERYDAY SENTENCES ----------
    const SENTENCE_BANK = [
        // devoir (must)
        { english: "I must go to the store.", subject: "Je", rest: "aller au magasin.", correct: "dois" },
        { english: "You must study.", subject: "Tu", rest: "√©tudier.", correct: "dois" },
        { english: "She has to call her mother.", subject: "Elle", rest: "appeler sa m√®re.", correct: "doit" },
        { english: "We have to leave now.", subject: "Nous", rest: "partir maintenant.", correct: "devons" },
        { english: "You (formal) must arrive on time.", subject: "Vous", rest: "arriver √† l'heure.", correct: "devez" },
        { english: "They must finish the project.", subject: "Ils", rest: "finir le projet.", correct: "doivent" },
        
        // pouvoir (can)
        { english: "I can help you.", subject: "Je", rest: "t'aider.", correct: "peux" },
        { english: "Can you open the window?", subject: "Tu", rest: "ouvrir la fen√™tre ?", correct: "peux" },
        { english: "He can speak three languages.", subject: "Il", rest: "parler trois langues.", correct: "peut" },
        { english: "We can come tomorrow.", subject: "Nous", rest: "venir demain.", correct: "pouvons" },
        { english: "You can take a seat.", subject: "Vous", rest: "vous asseoir.", correct: "pouvez" },
        { english: "They can sleep here.", subject: "Ils", rest: "dormir ici.", correct: "peuvent" },
        
        // vouloir (want)
        { english: "I want coffee.", subject: "Je", rest: "du caf√©.", correct: "veux" },
        { english: "You want a croissant.", subject: "Tu", rest: "un croissant.", correct: "veux" },
        { english: "She wants to leave.", subject: "Elle", rest: "partir.", correct: "veut" },
        { english: "We want to eat.", subject: "Nous", rest: "manger.", correct: "voulons" },
        { english: "You want water?", subject: "Vous", rest: "de l'eau ?", correct: "voulez" },
        { english: "They want a break.", subject: "Ils", rest: "une pause.", correct: "veulent" },
        
        // aller (go)
        { english: "I am going to Paris.", subject: "Je", rest: "√† Paris.", correct: "vais" },
        { english: "You are going to school.", subject: "Tu", rest: "√† l'√©cole.", correct: "vas" },
        { english: "She is going to work.", subject: "Elle", rest: "au travail.", correct: "va" },
        { english: "We are going to the beach.", subject: "Nous", rest: "√† la plage.", correct: "allons" },
        { english: "You are going to the museum.", subject: "Vous", rest: "au mus√©e.", correct: "allez" },
        { english: "They are going to the pool.", subject: "Ils", rest: "√† la piscine.", correct: "vont" },
        
        // √™tre (be)
        { english: "I am tired.", subject: "Je", rest: "fatigu√©.", correct: "suis" },
        { english: "You are late.", subject: "Tu", rest: "en retard.", correct: "es" },
        { english: "She is at home.", subject: "Elle", rest: "chez elle.", correct: "est" },
        { english: "We are happy.", subject: "Nous", rest: "heureux.", correct: "sommes" },
        { english: "You are kind.", subject: "Vous", rest: "gentil.", correct: "√™tes" },
        { english: "They are students.", subject: "Ils", rest: "√©tudiants.", correct: "sont" },
        
        // avoir (have)
        { english: "I am hungry.", subject: "J'", rest: "faim.", correct: "ai" },
        { english: "You are thirsty.", subject: "Tu", rest: "soif.", correct: "as" },
        { english: "She is 15 years old.", subject: "Elle", rest: "quinze ans.", correct: "a" },
        { english: "We are lucky.", subject: "Nous", rest: "de la chance.", correct: "avons" },
        { english: "You have a dog.", subject: "Vous", rest: "un chien.", correct: "avez" },
        { english: "They have a car.", subject: "Ils", rest: "une voiture.", correct: "ont" },
        
        // -ER verbs (present)
        { english: "I work today.", subject: "Je", rest: "aujourd'hui.", correct: "travaille" },
        { english: "You sing well.", subject: "Tu", rest: "bien.", correct: "chantes" },
        { english: "He speaks French.", subject: "Il", rest: "fran√ßais.", correct: "parle" },
        { english: "We eat pasta.", subject: "Nous", rest: "des p√¢tes.", correct: "mangeons" },
        { english: "You sell books.", subject: "Vous", rest: "des livres.", correct: "vendez" },
        { english: "They play soccer.", subject: "Ils", rest: "au foot.", correct: "jouent" },
        
        // pass√© compos√© (avoir auxiliary)
        { english: "Yesterday I ate ice cream.", subject: "J'", rest: "mang√© la glace.", correct: "ai" },
        { english: "She watched a film.", subject: "Elle", rest: "regard√© un film.", correct: "a" },
        { english: "We finished the work.", subject: "Nous", rest: "fini le travail.", correct: "avons" },
        
        // pass√© compos√© (√™tre auxiliary)
        { english: "She arrived at 8 o'clock.", subject: "Elle", rest: "arriv√©e √† huit heures.", correct: "est" },
        { english: "We went to the museum.", subject: "Nous", rest: "all√©s au mus√©e.", correct: "sommes" },
        { english: "They stayed home.", subject: "Elles", rest: "rest√©es √† la maison.", correct: "sont" },
        
        // futur proche
        { english: "Tomorrow I am playing basketball.", subject: "Je", rest: "jouer au basket.", correct: "vais" },
        { english: "Tonight we are watching a film.", subject: "Nous", rest: "regarder un film.", correct: "allons" },
        { english: "They are visiting Paris.", subject: "Ils", rest: "visiter Paris.", correct: "vont" },
    ];

    // ---------- STATE ----------
    let currentSentence = null;
    let currentBlankFilled = false;
    let selectedVerb = null;

    // ---------- DOM elements ----------
    const englishEl = document.getElementById('englishSentence');
    const subjectEl = document.getElementById('subjectPart');
    const blankEl = document.getElementById('blankSpace');
    const restEl = document.getElementById('restOfSentence');
    const feedbackEl = document.getElementById('feedbackMessage');
    const verbContainer = document.getElementById('verbContainer');
    const resetBtn = document.getElementById('resetBtn');
    const nextBtn = document.getElementById('nextBtn');

    // ---------- CHALLENGE: generate verb list with MULTIPLE conjugated forms of the SAME verb ----------
    function generateTrickyOptions(correctVerb, subject) {
        // Step 1: Identify the base verb from the correct conjugation
        let infinitive = "";
        if (correctVerb.endsWith("e") && !(correctVerb === "ai" || correctVerb === "suis" || correctVerb === "vais" || correctVerb === "peux" || correctVerb === "veux")) infinitive = "er"; 
        // rough mapping ‚Äì we don't need exact infinitive; we just want to include other persons of the same verb
        
        // Build a rich pool of conjugations ‚Äì we deliberately include many forms of the same verb
        const verbFamilies = {
            // devoir
            "dois": ["dois", "doit", "devons", "devez", "doivent"],
            "doit": ["dois", "doit", "devons", "devez", "doivent"],
            "devons": ["dois", "doit", "devons", "devez", "doivent"],
            "devez": ["dois", "doit", "devons", "devez", "doivent"],
            "doivent": ["dois", "doit", "devons", "devez", "doivent"],
            // pouvoir
            "peux": ["peux", "peut", "pouvons", "pouvez", "peuvent"],
            "peut": ["peux", "peut", "pouvons", "pouvez", "peuvent"],
            "pouvons": ["peux", "peut", "pouvons", "pouvez", "peuvent"],
            "pouvez": ["peux", "peut", "pouvons", "pouvez", "peuvent"],
            "peuvent": ["peux", "peut", "pouvons", "pouvez", "peuvent"],
            // vouloir
            "veux": ["veux", "veut", "voulons", "voulez", "veulent"],
            "veut": ["veux", "veut", "voulons", "voulez", "veulent"],
            "voulons": ["veux", "veut", "voulons", "voulez", "veulent"],
            "voulez": ["veux", "veut", "voulons", "voulez", "veulent"],
            "veulent": ["veux", "veut", "voulons", "voulez", "veulent"],
            // aller
            "vais": ["vais", "vas", "va", "allons", "allez", "vont"],
            "vas": ["vais", "vas", "va", "allons", "allez", "vont"],
            "va": ["vais", "vas", "va", "allons", "allez", "vont"],
            "allons": ["vais", "vas", "va", "allons", "allez", "vont"],
            "allez": ["vais", "vas", "va", "allons", "allez", "vont"],
            "vont": ["vais", "vas", "va", "allons", "allez", "vont"],
            // √™tre
            "suis": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            "es": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            "est": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            "sommes": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            "√™tes": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            "sont": ["suis", "es", "est", "sommes", "√™tes", "sont"],
            // avoir
            "ai": ["ai", "as", "a", "avons", "avez", "ont"],
            "as": ["ai", "as", "a", "avons", "avez", "ont"],
            "a": ["ai", "as", "a", "avons", "avez", "ont"],
            "avons": ["ai", "as", "a", "avons", "avez", "ont"],
            "avez": ["ai", "as", "a", "avons", "avez", "ont"],
            "ont": ["ai", "as", "a", "avons", "avez", "ont"],
            // -ER verbs (manger, travailler, chanter, parler, jouer, vendre etc)
            "mange": ["mange", "manges", "mangeons", "mangez", "mangent"],
            "manges": ["mange", "manges", "mangeons", "mangez", "mangent"],
            "mangeons": ["mange", "manges", "mangeons", "mangez", "mangent"],
            "mangez": ["mange", "manges", "mangeons", "mangez", "mangent"],
            "mangent": ["mange", "manges", "mangeons", "mangez", "mangent"],
            "travaille": ["travaille", "travailles", "travaillons", "travaillez", "travaillent"],
            "travailles": ["travaille", "travailles", "travaillons", "travaillez", "travaillent"],
            "travaillons": ["travaille", "travailles", "travaillons", "travaillez", "travaillent"],
            "travaillez": ["travaille", "travailles", "travaillons", "travaillez", "travaillent"],
            "travaillent": ["travaille", "travailles", "travaillons", "travaillez", "travaillent"],
            "chante": ["chante", "chantes", "chantons", "chantez", "chantent"],
            "chantes": ["chante", "chantes", "chantons", "chantez", "chantent"],
            "parle": ["parle", "parles", "parlons", "parlez", "parlent"],
            "parles": ["parle", "parles", "parlons", "parlez", "parlent"],
            "joue": ["joue", "joues", "jouons", "jouez", "jouent"],
            "joues": ["joue", "joues", "jouons", "jouez", "jouent"],
            "jouent": ["joue", "joues", "jouons", "jouez", "jouent"],
            "vendez": ["vends", "vends", "vend", "vendons", "vendez", "vendent"], 
        };

        // default fallback if verb not in mapping: still include a variety of common verbs
        let candidateOptions = [];
        if (verbFamilies[correctVerb]) {
            candidateOptions = [...verbFamilies[correctVerb]];
        } else {
            // fallback: include correct + other common forms
            candidateOptions = [correctVerb, "fais", "fait", "dis", "dit", "mets", "met"];
        }

        // Add "distractor" verbs from other families to make it challenging but not impossible
        let distractors = ["suis", "es", "est", "sommes", "√™tes", "sont", "ai", "as", "a", "avons", "avez", "ont", "vais", "vas", "va", "allons", "allez", "vont", "dois", "doit", "devons", "devez", "doivent", "peux", "peut", "pouvons", "pouvez", "peuvent", "veux", "veut", "voulons", "voulez", "veulent", "mange", "manges", "mangeons", "mangez", "mangent", "travaille", "jouent"];
        
        // Shuffle distractors and pick 3-4 random ones
        let shuffledDistractors = shuffleArray([...distractors]);
        let selectedDistractors = shuffledDistractors.filter(v => !candidateOptions.includes(v) && v !== correctVerb).slice(0, 4);
        
        // Combine: family forms (4-6 verbs) + random distractors + always keep correct
        let combined = [...candidateOptions, ...selectedDistractors];
        combined = [...new Set(combined)]; // remove duplicates
        
        // Ensure correct verb is always present
        if (!combined.includes(correctVerb)) combined.push(correctVerb);
        
        // Shuffle heavily so the correct answer isn't obvious
        combined = shuffleArray(combined);
        
        // Limit to 10-12 buttons for clean layout
        if (combined.length > 12) combined = combined.slice(0, 12);
        
        return combined;
    }

    // ---------- Fisher‚ÄìYates shuffle ----------
    function shuffleArray(arr) {
        const copy = [...arr];
        for (let i = copy.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [copy[i], copy[j]] = [copy[j], copy[i]];
        }
        return copy;
    }

    // ---------- render verb buttons ‚Äì no subject, no color, but multiple tricky forms ----------
    function renderVerbButtons() {
        if (!currentSentence) return;
        
        const correct = currentSentence.correct;
        const options = generateTrickyOptions(correct, currentSentence.subject);
        
        let html = '';
        options.forEach(verb => {
            const disabledAttr = (currentBlankFilled && selectedVerb !== verb) ? 'disabled' : '';
            const disabledClass = (currentBlankFilled && selectedVerb !== verb) ? 'disabled' : '';
            html += `<button class="verb-btn ${disabledClass}" data-verb="${verb}" ${disabledAttr}>
                        ${verb}
                    </button>`;
        });
        verbContainer.innerHTML = html;
    }

    // ---------- update UI with current sentence ----------
    function updateSentenceDisplay() {
        if (!currentSentence) return;
        englishEl.textContent = currentSentence.english;
        subjectEl.textContent = currentSentence.subject;
        restEl.textContent = currentSentence.rest;
        
        if (currentBlankFilled && selectedVerb) {
            blankEl.textContent = selectedVerb;
            blankEl.classList.add('filled');
        } else {
            blankEl.textContent = '______';
            blankEl.classList.remove('filled');
        }
    }

    // ---------- feedback ----------
    function setFeedback(message, isCorrect = false) {
        feedbackEl.textContent = message;
        if (isCorrect) {
            feedbackEl.style.background = '#e6f4e6';
            feedbackEl.style.borderLeftColor = '#2b7a4b';
        } else {
            feedbackEl.style.background = '#fef9e7';
            feedbackEl.style.borderLeftColor = '#ffae42';
        }
    }

    // ---------- reset current sentence (clear blank) ----------
    function resetCurrent() {
        currentBlankFilled = false;
        selectedVerb = null;
        updateSentenceDisplay();
        renderVerbButtons();
        setFeedback('üëâ Trouve la bonne conjugaison.');
    }

    // ---------- load a new random sentence ----------
    function loadRandomSentence() {
        currentSentence = getRandomSentence();
        currentBlankFilled = false;
        selectedVerb = null;
        updateSentenceDisplay();
        renderVerbButtons();
        // No extra "Nouvelle phrase" text ‚Äì just neutral prompt
        setFeedback('üëâ Choisis la forme qui correspond au sujet.');
    }

    // ---------- get random sentence from bank ----------
    function getRandomSentence() {
        const randomIndex = Math.floor(Math.random() * SENTENCE_BANK.length);
        return { ...SENTENCE_BANK[randomIndex] };
    }

    // ---------- handle verb click (event delegation) ----------
    function handleVerbClick(e) {
        const btn = e.target.closest('.verb-btn');
        if (!btn) return;
        if (btn.classList.contains('disabled') || btn.hasAttribute('disabled')) return;
        if (!currentSentence) return;
        
        const verb = btn.dataset.verb;
        const isCorrect = (verb === currentSentence.correct);
        
        // fill blank
        currentBlankFilled = true;
        selectedVerb = verb;
        blankEl.textContent = verb;
        blankEl.classList.add('filled');
        
        // disable all buttons except the selected one
        const allBtns = document.querySelectorAll('.verb-btn');
        allBtns.forEach(b => {
            if (b.dataset.verb !== selectedVerb) {
                b.classList.add('disabled');
                b.setAttribute('disabled', 'disabled');
            } else {
                b.classList.remove('disabled');
                b.removeAttribute('disabled');
            }
        });
        
        // feedback
        if (isCorrect) {
            setFeedback('‚úÖ Parfait ! Bonne conjugaison.', true);
        } else {
            setFeedback(`‚ùå ¬´ ${verb} ¬ª ne convient pas pour ¬´ ${currentSentence.subject} ¬ª. Essaie encore.`, false);
        }
    }

    // ---------- INIT ----------
    function init() {
        currentSentence = getRandomSentence();
        currentBlankFilled = false;
        selectedVerb = null;
        updateSentenceDisplay();
        renderVerbButtons();
        setFeedback('üëâ Trouve la bonne conjugaison.');
        
        // event listeners
        verbContainer.addEventListener('click', handleVerbClick);
        resetBtn.addEventListener('click', resetCurrent);
        nextBtn.addEventListener('click', loadRandomSentence);
    }

    init();
</script>

<style>
    .verb-btn {
        background: white;
        border: 2px solid #dae6ed;
    }
    .verb-btn:hover:not(.disabled):not([disabled]) {
        background: #f0f7fc;
        border-color: #94b5c9;
    }
    .btn-group .btn {
        transition: all 0.1s;
    }
</style>

</body>
</html>